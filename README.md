# Padmanabhan-et-al. Protein Distribution and Monte Carlo Analysis Code

Associated with the _Padmanabhan et al. Cell_ Publication:

Nirmala Padmanabhan, Rebecca E. Twilley, Grace Jones, Shinichiro Oku, Mir Sohayeb Rabbi, Sandesh Acharya, Mohammed Abrar Basha, Dinu Rajapakse, Cosette Koltek, Nabiha Ameena, Noushin Amanpour, Ying Lao, Jiami Guo, Rene Zahedi, Mohiuddin Ahmad, Martin Hruska, Tabrez J. Siddiqui

Neurexin1γ mediates synaptic transmission through structural integration of neurotransmitter release machinery and postsynaptic receptor nanodomains 

This repository contains MATLAB and Python scripts used to analysis the protein distribution of hippocampal tissue samples using fluorescence images, and to perform Monte Carlo statistical analysis of protein clustering and nearest-neighbor distances in 3D space.

The sequence of operations:

1) Imaris Analysis: Spot-to-Spot Distance Measurement XTension (Batch Compatible)
This set of MATLAB XTensions, originally developed by Matthew J. Gastinger, enables automated batch quantification of spatial relationships between spot objects in Imaris .ims files. The first script, SpotSpotDistance, measures the Euclidean distance from each spot in one object to all spots in a second object, saving minimum, mean, and maximum distances to a CSV file and embedding them in the Imaris statistics for downstream visualization or analysis. It supports multiple spot pairs per file and generates comprehensive pairwise metrics.
The second script, XTBatchProcess, is a general-purpose Imaris batch processor. It prompts the user to choose one of their available XTensions and processes all .ims files in a selected directory and its subfolders, applying the selected function and saving results to a user-defined output folder. It was modified by Noushin Ahmadpour to integrate with SpotSpotDistance for large-scale processing of spatial synaptic analysis. 

2) Monte Carlo Validation Model
This Python script performs a Monte Carlo simulation to quantify enrichment of protein proximity in expansion microscopy .excel files. It compares the observed mean nearest-neighbor distances between protein pairs to a null distribution generated by randomly distributing protein coordinates within a biologically constrained 3D volume. For each protein pair, the script computes percent enrichment—defined as the percentage decrease in observed mean distance relative to the null mean—and saves both real and null distance distributions to Excel files. It also generates a summary bar plot of enrichment values and exports a CSV file containing individual results.

3) Protein Clustering & Distance Analysis in Python
This Python script processes 3D spatial localization data of five synaptic proteins sets .excel files. It adjusts raw minimum distances using a user-defined expansion factor to recover actual minimum distances. The script identifies tri-partite interactions under 300 nm, bins the corrected distances into 20 nm intervals, and exports mean distance values for each protein pair  across all datasets in the input folder. Optionally, it performs enrichment analysis to count all interactions versus those within a functional complex (<300 nm), and outputs structured Excel files summarizing both raw and filtered results. Angle-based filtering of triads is available but disabled by default. Results are saved as Excel files for downstream plotting or statistical testing.

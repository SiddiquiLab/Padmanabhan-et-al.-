# Padmanabhan-et-al. Protein Distribution and Monte Carlo Analysis Code

Associated with the _Padmanabhan et al. Cell_ Publication:

Nirmala Padmanabhan, Rebecca E. Twilley, Grace Jones, Shinichiro Oku, Mir Sohayeb Rabbi, Sandesh Acharya, Mohammed Abrar Basha, Dinu Rajapakse, Cosette Koltek, Nabiha Ameena, Noushin Amanpour, Ying Lao, Jiami Guo, Rene Zahedi, Mohiuddin Ahmad, Martin Hruska, Tabrez J. Siddiqui

Neurexin1γ mediates synaptic transmission through structural integration of neurotransmitter release machinery and postsynaptic receptor nanodomains 

This repository contains MATLAB and Python scripts used to analysis the protein distribution of hippocampal tissue samples using fluorescence images, and to perform Monte Carlo statistical analysis of protein clustering and nearest-neighbor distances in 3D space.

The sequence of operations:

1) Imaris Analysis: Spot-to-Spot Distance Measurement XTension
Files: CentreOfMassToSpots.m, SpotSpotDistance.m, XBatchProcess.m
Developed by Matthew J. Gastinger, modified by Noushin Ahmadpour

  This set of MATLAB XTensions enables automated batch quantification of spatial relationships between spot objects in Imaris .ims files. The first script, CentreOfMassToSpots.m automates the conversion of surface objects into spot objects by extracting their center of homogeneous mass. The script operates across all time points and processes either selected surfaces or, if none are selected, all surfaces present. Each surface’s center is converted into a spot with a fixed 1 µm radius and inherits the original surface's color and tracking information. The resulting spot object is appended to the Imaris scene. The second script SpotSpotDistance.m, measures the Euclidean distance from each spot object in one protein to all spots in a second protein, saving minimum, mean, and maximum distances to a CSV file and embedding them in the Imaris statistics for downstream visualization or analysis. It supports multiple spot pairs per file and generates comprehensive pairwise metrics.
  
  The third script XTBatchProcess.m is an Imaris batch processor that functions with the CentreOfMassToSpots.m. It prompts the user to choose one of their available XTensions and processes all .ims files in a selected directory and its subfolders, applying the selected function and saving results to a user-defined output folder. Additonally XTBatchProcess_spot.m works the same as XTBatchProcess.m but functions with the SpotSpotDistance.m script.


3) Monte Carlo Validation Model
Files: monte_carlo.py
Developed by Rebecca E. Twilley
  This Python script performs a Monte Carlo simulation to quantify enrichment of protein proximity in expansion microscopy .excel files. It compares the observed mean nearest-neighbor distances between protein pairs to a null distribution generated by randomly distributing protein coordinates within a biologically constrained 3D volume. For each protein pair, the script computes percent enrichment—defined as the percentage decrease in observed mean distance relative to the null mean—and saves both real and null distance distributions to Excel files. It also generates a summary bar plot of enrichment values and exports a CSV file containing individual results.


4) Protein Clustering & Distance Analysis in Python
Files: flag_bassoon_glua2_protein_analysis.py, flag_rim_bassoon_protein_analysis.py, flag_glua1_glua2_protein_analysis.py, flag_rim_cav2_1_protein_analysis.py, flag_rim_homer_protein_analysis.py
Developed by Rebecca E. Twilley
   These Python scripts process 3D spatial localization data of five synaptic proteins sets .excel files derived from Imaris. It adjusts raw minimum distances using a user-defined expansion factor to recover actual minimum distances. The script identifies tri-partite interactions under 300 nm, bins the corrected distances into 20 nm intervals, and exports mean distance values for each protein pair  across all datasets in the input folder. Optionally, it performs enrichment analysis to count all interactions versus those within a functional complex (<300 nm), and outputs structured Excel files summarizing both raw and filtered results. Angle-based filtering of triads is available but disabled by default. Results are saved as Excel files for downstream plotting or statistical testing.

5) Protein Dimension Analysis
Files: Step_1_dimension_analysis_individual_protein_analysis.py, Step_2_dimension_analysis_merge_proteins.py, Step_3_dimension_analysis_data_visualization.py
Developed by Rebecca E. Twilley
  This three-step pipeline using Python scripts extracts, merges, and visualizes the dimensions of synaptic protein .excel files derived from Imaris.
  Step 1 – Individual Protein Analysis (Step_1_dimension_analysis_individual_protein_analysis.py): This script reads raw volume and bounding box measurements from Imaris (OrientatedObjectOO and Volume tables), applies expansion factor correction, and calculates the true length, width, thickness, and volume for each structure. Results are saved as separate Excel files for each protein.

  Step 2 (optional) – Merging Protein Data (Step_2_dimension_analysis_merge_proteins.py): This script combines individual protein .excel files (from Step 1) into a single file per protein, organized by data type (e.g., Length, Volume). It also generates violin plots of corrected length and volume distributions for merged datasets. This step is only required if there are multiple dimension_analysis.excel files obtained from step 1 per protein.

  Step 3 – Data Visualization (Step_3_dimension_analysis_data_visualization.py): This script compiles merged protein data and produces violin plots for all proteins’ lengths and volumes, with median values, and exports summary statistics to an Excel file.

5) Additional Files
Files: add_range_together_columns.py, combine_mean_data_together.py, create_a_graph.py
  These Pyhon scripts combine the range and mean data together obtained from the Protein Clustering & Distance Analysis Python scripts. The output from these files can then be used in create_a_graph.py for data visualization.

Those scripts have been tested in MATLAB R2021a and Google Colab.

